# Week 02 作业：猜数字游戏

> "The only way to learn a new programming language is by writing programs in it."
> — Dennis Ritchie, C 语言之父

## 作业目标

完成本周作业后，你将能够：

1. 使用 `if`/`elif`/`else` 语句编写条件判断逻辑
2. 编写布尔表达式，使用比较运算符和逻辑运算符
3. 使用 `while` 循环实现重复执行
4. 使用 `for` 循环配合 `range()` 控制执行次数
5. 使用 `break` 和 `continue` 控制循环流程
6. 理解 Python 的缩进规则，避免常见错误

---

## 基础作业（必做）

### 任务描述

编写一个猜数字游戏程序 `guess_number.py`。程序会随机生成一个 1-100 之间的数字，玩家需要在最多 5 次机会内猜中它。

### 功能要求

1. **随机生成答案**
   - 使用 `random.randint(1, 100)` 生成 1-100 之间的随机整数
   - 这个数字对玩家保密，不直接显示

2. **循环猜测**
   - 玩家最多有 5 次猜测机会
   - 每次猜测后，程序告诉玩家"大了"、"小了"或"猜对了"
   - 如果猜中，立即结束游戏并显示祝贺信息
   - 如果 5 次都没猜中，显示正确答案

3. **提示信息**
   - 显示当前是第几次猜测
   - 每次猜测后，如果还有剩余机会，显示剩余次数

### 输入/输出示例

**示例 1：猜中情况**

```
=== 猜数字游戏 ===
我已经想好了一个 1 到 100 之间的数字，你有 5 次机会猜中它！

第 1 次猜测，请输入数字：50
太小了
还有 4 次机会

第 2 次猜测，请输入数字：75
太大了
还有 3 次机会

第 3 次猜测，请输入数字：62
太小了
还有 2 次机会

第 4 次猜测，请输入数字：68
太小了
还有 1 次机会

第 5 次猜测，请输入数字：70
恭喜！你用了 5 次猜中了答案 70！
```

**示例 2：未猜中情况**

```
=== 猜数字游戏 ===
我已经想好了一个 1 到 100 之间的数字，你有 5 次机会猜中它！

第 1 次猜测，请输入数字：30
太大了
还有 4 次机会

第 2 次猜测，请输入数字：15
太大了
还有 3 次机会

第 3 次猜测，请输入数字：8
太大了
还有 2 次机会

第 4 次猜测，请输入数字：3
太小了
还有 1 次机会

第 5 次猜测，请输入数字：5
太小了

很遗憾，5 次都用完了。答案是 7
```

### 提示

1. **导入 random 模块**
   ```python
   import random
   secret = random.randint(1, 100)
   ```

2. **使用 for 循环控制次数**
   ```python
   for attempt in range(5):
       # attempt 的值是 0, 1, 2, 3, 4
       # 显示时用 attempt + 1 变成 1, 2, 3, 4, 5
   ```

3. **比较猜测和答案**
   ```python
   if guess == secret:
       # 猜对了
   elif guess < secret:
       # 太小了
   else:
       # 太大了
   ```

4. **跳出循环**
   - 使用 `break` 语句在猜中时立即退出循环
   - 记住：`break` 要写在 `if` 条件里

### 常见错误

小北第一次写的时候遇到了几个问题，看看你能避开吗？

**错误 1：忘记 `break`**

```python
if guess == secret:
    print("恭喜你猜对了！")
    # 小北忘记写 break 了
```

结果：猜对了之后还在继续循环，又问了 4 次。

**错误 2：`range()` 的值搞错了**

```python
for attempt in range(1, 6):
    # 这样也能工作，但 attempt + 1 就变成 2, 3, 4, 5, 6 了
```

提示：如果想用 `range(1, 6)`，显示时就不需要 `+ 1` 了。选择一种方式保持一致。

**错误 3：缩进对齐错误**

```python
for attempt in range(5):
    guess = int(input(...))
    if guess == secret:
        print("恭喜！")
        break
else:
    # 这个 else 要和 for 对齐，不是和 if 对齐
    print("很遗憾...")
```

记住：`for...else` 中的 `else` 会在循环"正常结束"（没被 `break` 打断）时执行。

---

## 进阶作业（选做）

### 任务描述

在基础版本上添加更多功能和交互体验。

### 功能要求（至少完成 2 项）

#### 1. 输入验证

检查用户输入是否为有效数字：

- 如果用户输入的不是数字（如 "abc"），提示"请输入一个数字"
- 如果数字不在 1-100 范围内，提示"数字必须在 1 到 100 之间"
- 这两种情况都不消耗猜测次数

**示例：**
```
第 1 次猜测，请输入数字：abc
请输入一个有效的数字！

第 1 次猜测，请输入数字：150
数字必须在 1 到 100 之间！

第 1 次猜测，请输入数字：50
太大了
```

**提示：**
- 使用 `try...except` 处理非数字输入
- 或者使用字符串的 `.isdigit()` 方法检查
- 无效输入时使用 `continue` 跳过本次循环，不增加次数

#### 2. 难度选择

游戏开始前让玩家选择难度：

- 简单：1-50，最多 7 次机会
- 中等：1-100，最多 5 次机会
- 困难：1-200，最多 5 次机会

**示例：**
```
=== 猜数字游戏 ===
请选择难度：
1. 简单（1-50，7 次机会）
2. 中等（1-100，5 次机会）
3. 困难（1-200，5 次机会）

请输入难度（1-3）：2

我已经想好了一个 1 到 100 之间的数字，你有 5 次机会猜中它！
...
```

**提示：**
- 先用 `input()` 获取难度选择
- 用 `if/elif/else` 根据选择设置不同的 `max_num` 和 `max_attempts`
- 用 `random.randint(1, max_num)` 生成答案

#### 3. 游戏统计

记录玩家的历史战绩：

- 显示胜利次数和失败次数
- 计算"平均猜测次数"（只在胜利时计算）
- 游戏结束时询问"还要再玩一次吗？"

**示例：**
```
=== 猜数字游戏 ===
当前战绩：3 胜 2 负，平均 3.7 次猜中

我已经想好了一个 1 到 100 之间的数字...
...

恭喜！你用了 4 次猜中了答案 70！

还要再玩一次吗？(y/n)：y
```

**提示：**
- 用两个变量记录 `wins` 和 `losses`
- 用一个变量累加总猜测次数 `total_attempts`
- 用 `while True` 外层循环包裹游戏，输入 'n' 时 `break`

---

## 挑战作业（选做）

### 任务 1：二分查找提示

给玩家一个"智能提示"功能：如果玩家连续 2 次都没猜中，程序提示一个推荐数字（使用二分查找策略）。

**示例：**
```
第 1 次猜测，请输入数字：30
太小了

第 2 次猜测，请输入数字：80
太大了

💡 提示：根据你之前的猜测，答案可能在 31 到 79 之间，建议试试 55

第 3 次猜测，请输入数字：55
...
```

**提示：**
- 记录玩家猜测过的最小值和最大值
- 用 `(min_val + max_val) // 2` 计算推荐值
- 用一个变量记录是否已经给出过提示，避免重复提示

### 任务 2：倒计时模式

增加一个限时模式：玩家只有 30 秒时间完成所有猜测。

**示例：**
```
=== 猜数字游戏（限时模式）===

⏱️ 剩余时间：30 秒

第 1 次猜测，请输入数字：50
太大了

⏱️ 剩余时间：25 秒

第 2 次猜测，请输入数字：...
```

**提示：**
- 这是 Week 05 之后才会学到的内容，需要自学：
  - `import time`
  - `start_time = time.time()` 记录开始时间
  - `time.time() - start_time` 计算已用时间
  - `30 - (time.time() - start_time)` 计算剩余时间

### 任务 3：思考题（与 AI 相关）

阿码看了一眼你的代码，说："这个游戏太简单了，让 AI 来写不是几秒钟的事吗？而且 AI 肯定能写得更快更聪明。"

请你思考并回答：

1. 如果让 AI 来写这个猜数字游戏，你觉得它可能会怎么写？和你写的有什么不同？
2. 如果 AI 给你一段猜数字游戏的代码，你会从哪些方面检查它的质量？
3. 为什么在学习编程的初期，我们需要先手写代码，而不是直接依赖 AI？手写代码能帮你建立哪些 AI 无法替代的理解？

把你的思考写成 200-300 字的简短回答。

---

## 提交要求

### 文件结构

```
chapters/week_02/
├── ASSIGNMENT.md           # 本文件
├── RUBRIC.md               # 评分标准
├── guess_number.py         # 你的作业代码（基础/进阶版本）
└── guess_number_bonus.py   # 挑战版本（可选）
```

### Git 提交

- 至少提交 2 次：
  1. `draft: 猜数字游戏基础版本`
  2. `verify: 完成基础作业并通过测试`
- 如果做了进阶/挑战，分别再提交：
  - `feat: 添加输入验证和难度选择`
  - `bonus: 完成挑战任务`

### 运行测试

提交前请确保通过所有测试：

```bash
python3 -m pytest chapters/week_02/tests -q
```

---

## 参考实现

如果你遇到困难，可以参考 `starter_code/solution.py` 中的实现。但建议先自己尝试，遇到困难时再查看。

**提示：** 参考实现只是一种写法，你的代码可能完全不同，但只要能正确运行并满足要求就是好的。

---

## 作业检查清单

提交前请确认：

- [ ] 代码可以正常运行，没有报错
- [ ] 使用了 `for` 循环或 `while` 循环
- [ ] 使用了 `if/elif/else` 进行条件判断
- [ ] 正确使用了比较运算符（`==`, `<`, `>`）
- [ ] 使用了 `break` 在猜中时退出循环
- [ ] 输出信息清晰，包含必要的提示
- [ ] 变量命名清晰有意义（不是 `a`、`b`、`c`）
- [ ] 包含必要的注释说明代码功能
- [ ] 通过 `pytest` 测试
- [ ] Git 提交历史清晰（至少 2 次提交）
