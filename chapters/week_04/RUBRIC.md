# Week 04 评分标准

## 评分维度概览

| 维度 | 占比 | 说明 |
|------|------|------|
| **功能正确性** | 30% | Git 工作流使用正确，代码功能完整 |
| **协作能力** | 30% | PR 质量，Code Review 质量，反馈建设性 |
| **ADR 质量** | 25% | ADR-002 的完整性、决策质量 |
| **工程实践** | 15% | 代码规范，审查清单使用，冲突处理 |

---

## 详细评分标准

### 一、功能正确性（30 分）

#### 1.1 Git 工作流使用（15 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| Feature Branch 创建正确 | 5 分 | 从 main 创建，命名规范（feature/xxx） |
| Commit Message 规范 | 4 分 | 使用 feat:/fix:/docs: 等前缀，描述清晰 |
| 分支历史清晰 | 3 分 | 提交历史有意义，无杂乱提交 |
| 合并流程正确 | 3 分 | 通过 PR 合并，不在 main 直接提交 |

**示例**（好的 Git 工作流）：
```bash
# 好的分支命名
git checkout -b feature/task-stats

# 好的提交信息
git commit -m "feat: 添加任务统计功能（按优先级和状态）"
git commit -m "fix: 修复 countByPriority 的 NPE 问题"
git commit -m "refactor: 根据 Code Review 意见优化异常处理"
```

**示例**（不好的 Git 工作流）：
```bash
# 不好的分支命名
git checkout -b my-branch
git checkout -b fix

# 不好的提交信息
git commit -m "update"
git commit -m "fix bug"
git commit -m "WIP"
```

**评分细则**：
- **13-15 分**：Git 工作流规范，分支历史清晰，提交信息规范
- **10-12 分**：基本正确，个别提交信息可以改进
- **6-9 分**：能使用分支，但存在明显问题（如在 main 提交）
- **0-5 分**：Git 使用不正确或缺失

---

#### 1.2 代码功能完整性（15 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| TaskStats 类实现 | 5 分 | 包含必要字段和 getter，封装良好 |
| 统计方法实现 | 5 分 | getStatistics 和 countByPriority 功能正确 |
| 输入验证 | 3 分 | 防御式编程，检查 null 和空列表 |
| 异常处理 | 2 分 | 异常处理完善，不抛出原始异常 |

**示例**（好的代码）：
```java
public class TaskStats {
    private final int totalCount;
    private final int completedCount;
    private final int pendingCount;

    public TaskStats(int total, int completed, int pending) {
        if (total < 0 || completed < 0 || pending < 0) {
            throw new IllegalArgumentException("统计值不能为负数");
        }
        this.totalCount = total;
        this.completedCount = completed;
        this.pendingCount = pending;
    }

    // getter 方法...
}
```

**评分细则**：
- **13-15 分**：功能完整，验证充分，异常处理完善
- **10-12 分**：基本功能正确，个别边界情况可以补充
- **6-9 分**：功能基本实现，但存在问题（如缺少验证）
- **0-5 分**：功能缺失或严重错误

---

### 二、协作能力（30 分）

#### 2.1 Pull Request 质量（12 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| PR 标题清晰 | 3 分 | 使用 feat:/fix:/docs: 前缀，描述改动内容 |
| PR 描述完整 | 5 分 | 包含改动内容、测试方式、审查清单 |
| 审查清单完整 | 4 分 | 至少 5 项检查项，覆盖设计/代码/测试 |

**示例**（好的 PR 描述）：
```markdown
## 改动内容
添加任务统计功能，支持查看总体统计和按优先级统计。

### 新增方法
- `getStatistics()`：返回 TaskStats 对象
- `countByPriority()`：返回 Map<优先级, 数量>

## 测试方式
1. 运行 TaskManagerTest 中的测试用例
2. 手动测试：在 CLI 中创建任务后查看统计

## 审查清单
- [ ] 代码符合 Java 命名规范
- [ ] 新增方法有适当的注释
- [ ] 异常处理完善（考虑空列表情况）
- [ ] 单元测试覆盖新增功能
- [ ] 符合单一职责原则
```

**示例**（不好的 PR 描述）：
```markdown
添加统计功能

测试过了，没问题。
```

**评分细则**：
- **10-12 分**：PR 描述完整，审查清单全面，测试方式清晰
- **7-9 分**：基本完整，个别部分可以补充
- **4-6 分**：描述简单，缺少关键信息
- **0-3 分**：PR 描述缺失或质量差

---

#### 2.2 Code Review 质量（12 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 使用审查清单 | 4 分 | 使用系统化检查清单，逐项检查 |
| 发现问题数量 | 4 分 | 发现至少 3 个有意义的问题 |
| 反馈建设性 | 4 分 | 解释原因，提供选项，态度尊重 |

**示例**（好的审查反馈）：
```markdown
### 问题 1：潜在空指针异常
**位置**：`countByPriority` 方法第 12 行
**问题**：`counts.get(priority)` 可能返回 null，导致 NPE
**建议**：使用 `getOrDefault(priority, 0) + 1`，或者先检查 containsKey

### 问题 2：缺少空列表检查
**位置**：`getStatistics` 方法
**问题**：当 tasks 为空列表时，行为是否明确？
**建议**：添加注释说明空列表返回的统计信息，或添加前置检查
```

**示例**（不好的审查反馈）：
```markdown
这里有 bug。
你代码写错了。
这不行。
```

**评分细则**：
- **10-12 分**：使用审查清单，发现 3+ 问题，反馈建设性
- **7-9 分**：基本使用清单，发现 2-3 个问题，反馈基本合理
- **4-6 分**：发现问题较少，反馈简单
- **0-3 分**：缺少 Code Review 或质量差

---

#### 2.3 反馈处理（6 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 响应审查意见 | 3 分 | 对每条意见都有回应（接受或解释） |
| 修改质量 | 3 分 | 根据意见修改的代码质量 |

**评分细则**：
- **5-6 分**：积极回应意见，修改质量高
- **3-4 分**：基本回应意见，修改基本合理
- **1-2 分**：回应较少或修改有问题
- **0 分**：未处理审查意见

---

### 三、ADR 质量（25 分）

#### 3.1 ADR 完整性（15 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 结构完整 | 5 分 | 包含状态、背景、决策、理由、替代方案、后果 |
| 方案对比 | 5 分 | 至少对比 3 种方案，优缺点分析清晰 |
| 验证方式 | 3 分 | 列出可验证的检查项 |
| 格式规范 | 2 分 | 使用 Markdown 格式，层次清晰 |

**示例**（好的 ADR 结构）：
```markdown
# ADR-002: 数据存储方案决策

## 状态
已采纳

## 背景
CampusFlow 目前使用内存存储...

## 决策
我们选择 SQLite...

## 理由
1. 持久化需求...
2. 查询能力...

## 替代方案
### 方案 A：内存存储
- 优点：...
- 缺点：...

### 方案 B：文件存储
...

## 后果
### 正面影响
- ...

### 负面影响
- ...

## 验证方式
- [ ] Week 05：完成 FileTaskRepository
```

**评分细则**：
- **13-15 分**：ADR 结构完整，方案对比充分，验证方式清晰
- **10-12 分**：基本完整，个别部分可以补充
- **6-9 分**：结构有缺失，分析不够深入
- **0-5 分**：ADR 缺失或质量差

---

#### 3.2 决策质量（10 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 决策明确 | 3 分 | 有明确的决策，不模棱两可 |
| 理由充分 | 4 分 | 决策理由充分，考虑业务约束 |
| 风险分析 | 3 分 | 分析正面和负面影响，有缓解措施 |

**评分细则**：
- **9-10 分**：决策明确，理由充分，风险分析到位
- **6-8 分**：决策基本合理，理由可以补充
- **3-5 分**：决策模糊或理由不充分
- **0-2 分**：决策质量差

**重要**：
- ADR 必须由人写，不能用 AI 代劳决策内容
- 如果发现 ADR 决策内容明显是 AI 生成的通用内容，扣 10 分

---

### 四、工程实践（15 分）

#### 4.1 代码规范（5 分）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 命名规范 | 2 分 | 类名、方法名、变量名清晰 |
| 代码格式 | 2 分 | 缩进、空格、换行规范 |
| 注释 | 1 分 | 有必要的注释，解释"为什么" |

**评分细则**：
- **5 分**：完全符合规范
- **4 分**：基本符合，小问题
- **2-3 分**：有风格问题
- **0-1 分**：风格混乱

---

#### 4.2 冲突处理（5 分，进阶题）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 冲突场景描述 | 2 分 | 清晰描述冲突如何产生 |
| 解决过程 | 2 分 | 展示冲突标记，解释解决思路 |
| 经验总结 | 1 分 | 总结避免冲突的最佳实践 |

**评分细则**：
- **5 分**：冲突处理完整，有深度总结
- **3-4 分**：基本完整，总结可以补充
- **1-2 分**：描述简单
- **0 分**：未做冲突处理任务

---

#### 4.3 AI 协作练习（5 分，可选）

| 评分项 | 分数 | 标准 |
|--------|------|------|
| 发现问题数量 | 3 分 | 发现至少 3 个 AI 代码的问题 |
| 修复质量 | 2 分 | 修复后的代码质量 |

**评分细则**：
- **5 分**：发现 3+ 问题，修复质量高
- **3-4 分**：发现 2-3 个问题，修复基本合理
- **1-2 分**：发现问题较少
- **0 分**：未做 AI 协作练习

---

## 进阶题与挑战题（额外加分）

### 进阶题（+20 分）

| 任务 | 分数 | 评分标准 |
|------|------|---------|
| 任务 5：处理审查反馈 | 10 分 | 积极回应意见，修改质量高 |
| 任务 6：冲突解决 | 10 分 | 冲突场景真实，解决思路清晰 |

**评分细则**：
- **9-10 分**：完全实现，质量高
- **7-8 分**：基本实现，部分可以改进
- **4-6 分**：实现不完整或有明显问题
- **0-3 分**：尝试了但未能完成

---

### 挑战题（+20 分）

| 任务 | 分数 | 评分标准 |
|------|------|---------|
| 任务 7：团队代码规范 | 20 分 | 规范完整，可执行，有示例 |

**评分细则**：
- **18-20 分**：规范全面，具体可执行，示例清晰
- **15-17 分**：规范完整，有示例
- **10-14 分**：有规范，但不够具体
- **5-9 分**：尝试了但质量不高
- **0-4 分**：未完成

---

### AI 协作练习（+10 分，额外）

完成 AI 代码审查练习，发现 AI 代码的问题并修复。

---

## 总分计算

### 基础分（100 分）
- 功能正确性：30 分
- 协作能力：30 分
- ADR 质量：25 分
- 工程实践：15 分

### 额外加分（最多 +50 分）
- 进阶题：+20 分
- 挑战题：+20 分
- AI 协作练习：+10 分

### 最终等级
- **A（90-100 分）**：基础分 90+，或基础分 80+ + 至少一个进阶题
- **B（80-89 分）**：基础分 80+
- **C（70-79 分）**：基础分 70+
- **D（60-69 分）**：基础分 60+
- **F（<60 分）**：基础分 <60

---

## 常见扣分项

| 问题 | 扣分 | 说明 |
|------|------|------|
| 直接在 main 分支开发 | -15 分 | 违反 Feature Branch 工作流 |
| PR 描述过于简单 | -8 分 | 缺少关键信息 |
| Code Review 流于形式 | -10 分 | 未使用审查清单，反馈简单 |
| ADR 用 AI 代写决策内容 | -10 分 | ADR 必须由人写 |
| ADR 缺少方案对比 | -8 分 | 没有对比至少 3 种方案 |
| 缺少输入验证 | -8 分 | 未应用防御式编程 |
| Commit Message 不规范 | -5 分 | 缺少前缀或描述不清 |
| 冲突解决记录不完整 | -5 分 | 未展示冲突标记 |

---

## 快速自查清单

提交前请检查：

### Git 工作流
- [ ] 使用 feature 分支开发（不是 main）
- [ ] 分支命名规范（feature/xxx）
- [ ] Commit Message 使用 feat:/fix:/docs: 前缀
- [ ] 提交历史清晰，无杂乱提交

### Pull Request
- [ ] PR 标题清晰（feat: 描述）
- [ ] PR 描述包含改动内容、测试方式
- [ ] 包含审查清单（至少 5 项）

### Code Review
- [ ] 使用审查清单逐项检查
- [ ] 发现至少 3 个问题
- [ ] 反馈建设性（解释原因、提供选项）

### ADR
- [ ] 结构完整（状态、背景、决策、理由、替代方案、后果）
- [ ] 对比至少 3 种方案
- [ ] 决策理由充分
- [ ] **决策内容由人写，非 AI 生成**

### 代码质量
- [ ] 代码功能正确
- [ ] 包含输入验证（防御式编程）
- [ ] 异常处理完善
- [ ] 命名清晰，格式规范

### 提交
- [ ] ADR 在 `docs/adr/002-数据存储方案.md`
- [ ] 代码在 `src/main/java/edu/campusflow/` 目录下
- [ ] Git commit message 清晰
- [ ] PR 链接或截图已提交
