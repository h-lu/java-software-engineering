# Week 03 作业：把问题切小

> **本次作业目标**：掌握函数的定义、参数传递、返回值和作用域，学会用函数分解复杂问题。

---

## 基础作业（必做）

### 题目 1：温度换算器

写一个程序，把摄氏度转换为华氏度。要求：

1. 定义一个函数 `celsius_to_fahrenheit(celsius)`，接收一个参数 `celsius`
2. 函数返回换算后的华氏度值（使用公式：`F = C × 9/5 + 32`）
3. 在主程序中调用这个函数三次，分别传入 0、37、100，打印结果

**输入输出示例**：

```
0°C = 32.0°F
37°C = 98.6°F
100°C = 212.0°F
```

**提示**：
- 记得用 `return` 返回结果，而不是直接 `print`
- 可以在 print 时用 f-string 格式化小数位数：`f"{result:.1f}°F"`

**评分点**：
- [ ] 正确定义函数（`def` 语句、参数、冒号、缩进）
- [ ] 正确使用 `return` 返回计算结果
- [ ] 正确调用函数并传入参数
- [ ] 输出格式符合要求

---

### 题目 2：计算矩形面积和周长

定义两个函数：

1. `rectangle_area(width, height)` —— 计算并返回矩形面积
2. `rectangle_perimeter(width, height)` —— 计算并返回矩形周长

然后在主程序中：
- 让用户输入矩形的宽度和高度
- 调用这两个函数
- 打印面积和周长

**输入输出示例**：

```
请输入矩形的宽度：5
请输入矩形的高度：3

面积：15
周长：16
```

**提示**：
- 面积公式：`面积 = 宽 × 高`
- 周长公式：`周长 = (宽 + 高) × 2`
- 用 `float(input())` 获取数字输入

**评分点**：
- [ ] 正确定义两个函数，每个函数都正确使用参数
- [ ] 两个函数都正确使用 `return` 返回结果
- [ ] 正确处理用户输入（转换为数字）
- [ ] 输出格式清晰，包含面积和周长

---

## 进阶作业（必做）

### 题目 3：多单位换算器

参考本周贯穿案例，写一个支持多种单位换算的程序。要求：

1. 定义至少三个换算函数，每个函数：
   - 接收一个数值参数
   - 返回换算结果
   - 只做一件事（只负责一种换算）

2. 定义以下辅助函数：
   - `show_menu()` —— 显示菜单选项
   - `get_choice()` —— 获取用户选择，带输入验证（循环直到输入有效）
   - `do_conversion(choice)` —— 根据选择执行对应的换算

3. 在 `main()` 函数中用 `while` 循环让用户持续使用，直到选择退出

**输入输出示例**：

```
=== 单位换算器 ===
1. 公里 → 英里
2. 公斤 → 磅
3. 摄氏度 → 华氏度
4. 退出

请选择（1-4）：1
输入公里数：10
10.0 公里 = 6.21 英里

=== 单位换算器 ===
1. 公里 → 英里
2. 公斤 → 磅
3. 摄氏度 → 华氏度
4. 退出

请选择（1-4）：5
无效输入，请输入 1-4
请选择（1-4）：4
再见！
```

**提示**：
- 换算公式参考：
  - 公里 → 英里：`英里 = 公里 × 0.621371`
  - 公斤 → 磅：`磅 = 公斤 × 2.20462`
  - 摄氏度 → 华氏度：`°F = °C × 9/5 + 32`
- `get_choice()` 用 `while True` 循环，输入有效时 `return choice`
- 可以在 f-string 中用 `:.2f` 保留两位小数

**评分点**：
- [ ] 至少定义了 3 个换算函数，每个函数职责单一
- [ ] `show_menu()`、`get_choice()`、`do_conversion()` 三个函数正确实现
- [ ] `get_choice()` 包含输入验证（循环直到输入有效）
- [ ] `main()` 函数用 `while` 循环实现持续运行
- [ ] 所有函数正确使用参数和返回值
- [ ] 代码结构清晰，函数之间调用关系合理

---

### 题目 4：理解作用域

阅读以下代码，预测输出结果，然后运行验证你的理解：

```python
x = 10  # 全局变量

def test_function():
    x = 20  # 局部变量
    print("函数内 x:", x)

test_function()
print("函数外 x:", x)
```

**问题**：
1. 程序会输出什么？
2. 为什么函数内的 `x = 20` 不会影响外面的 `x`？
3. 如果你想在函数内修改全局变量 `x`，应该怎么做？

**提交**：
把你的答案写成一个文本文件 `scope_analysis.txt`，包含：
1. 预测的输出
2. 对第 2、3 问的解释

**评分点**：
- [ ] 正确预测程序输出
- [ ] 准确解释局部变量和全局变量的区别
- [ ] 知道如何用 `global` 关键字修改全局变量（即使不推荐这样做）

---

## 挑战作业（选做）

### 题目 5：带记忆的计算器

写一个简单的计算器程序，支持加减乘除运算，并且能记录历史计算。

**要求**：
1. 定义运算函数：`add(a, b)`、`subtract(a, b)`、`multiply(a, b)`、`divide(a, b)`
   - `divide` 函数要处理除零情况，返回提示字符串而不是报错

2. 定义一个全局变量 `history = []`，用来存储计算历史

3. 定义 `record_history(operation, result)` 函数：
   - 把计算记录添加到 `history` 列表中
   - 记录格式：`"操作符: 数字1 数字2 = 结果"`

4. 定义 `show_history()` 函数：
   - 打印所有历史计算记录
   - 如果没有历史，提示"暂无历史记录"

5. 在 `main()` 函数中：
   - 显示菜单（1. 加法 2. 减法 3. 乘法 4. 除法 5. 查看历史 6. 退出）
   - 根据用户选择调用对应函数
   - 每次计算后自动记录到历史

**输入输出示例**：

```
=== 简单计算器 ===
1. 加法
2. 减法
3. 乘法
4. 除法
5. 查看历史
6. 退出

请选择（1-6）：1
请输入第一个数字：10
请输入第二个数字：5
结果：15

请选择（1-6）：4
请输入第一个数字：10
请输入第二个数字：0
错误：不能除以零

请选择（1-6）：5
--- 计算历史 ---
1. 加法: 10 5 = 15
---

请选择（1-6）：6
再见！
```

**评分点**：
- [ ] 正确定义 4 个运算函数，每个函数返回计算结果
- [ ] `divide` 函数正确处理除零情况
- [ ] `record_history()` 函数正确添加记录到全局列表
- [ ] `show_history()` 函数正确打印历史或提示无历史
- [ ] `main()` 函数完整实现菜单循环和功能调用
- [ ] 代码结构清晰，函数职责单一

---

### 思考题（不需要提交）

> **如果让 AI 来写这个计算器，你觉得它会怎么写？**

想一想：
1. AI 会把所有代码写在一个函数里，还是拆成多个小函数？
2. AI 会用全局变量存历史，还是用其他方式？
3. 你觉得人写的代码和 AI 生成的代码，最大的区别可能在哪里？

如果你有机会使用 AI 编程工具（如 GitHub Copilot、ChatGPT），可以试试让它写一个计算器，然后对比一下它写的和你写的有什么不同。

**目的**：这个思考题不是为了让你使用 AI，而是让你开始思考"什么样的代码是好的代码"。下周我们会开始学习如何审查 AI 生成的代码。

---

## 通用要求

### 代码规范
- 所有函数名使用小写字母和下划线（如 `celsius_to_fahrenheit`）
- 每个函数开头用文档字符串（`"""..."""`）说明函数功能
- 缩进统一使用 4 个空格
- 变量命名清晰、有意义

### 测试要求
- 基础作业和进阶作业必须通过自动化测试：`python3 -m pytest chapters/week_03/tests -q`
- 挑战作业没有自动化测试，但建议你手动测试所有功能

### Git 提交要求
- 至少提交 2 次：
  - 第一次：`git commit -m "draft: 实现基础作业"`
  - 第二次：`git commit -m "feat: 完成进阶作业和挑战题"`
- 建议尝试使用分支：`git switch -c unit-converter`

### 遇到困难？
- 如果某个功能卡住了，可以参考 `starter_code/solution.py` 中的参考实现
- 但建议先自己思考 15 分钟，再去看参考答案

---

## 作业提交检查清单

提交前请确认：

- [ ] 完成基础作业（题目 1、2）
- [ ] 完成进阶作业（题目 3、4）
- [ ] 代码能正常运行，没有语法错误
- [ ] 通过所有自动化测试（如果有）
- [ ] 至少提交 2 次 Git 记录
- [ ] 尝试了分支工作流（选做，但强烈推荐）

---

**本周重点**：函数不只是"少写代码"，更是"改动时只改一个地方"。如果你发现自己复制粘贴了相同的代码，那就是需要用函数的信号。
